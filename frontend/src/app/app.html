<main class="container">
    <header>
        <h1>Analisador de Entidades com IA</h1>
        <p>Projeto de Desafio - FASA/UNICAP - Marcos Capella</p>
    </header>

    <section class="form-section">
        <textarea 
            placeholder="Digite o texto a ser analisado..."
            [disabled]="isLoading()"
            [(ngModel)]="inputText">
        </textarea>
        <button (click)="submitAnalysis()" [disabled]="isLoading() || !inputText()">
            Analisar
        </button>
    </section>

    <section class="state-section" *ngIf="isLoading()">
        <div class="spinner"></div>
        <p>Analisando...</p>
    </section>

    <section class="state-section error" *ngIf="error()"> 
        <p>{{ error() }}</p>
    </section>

    <section class="result-section" *ngIf="analysisResult()">
        <h2>Texto Analisado:</h2>
        <div class="highlighted-text-container" [innerHTML]="highlightedHtml()">
        </div>

        <h3>Entidades Encontradas:</h3>
        <div class="entities-container" *ngIf="analysisResult()?.result?.['entities']?.length > 0; else noEntities">
            <span *ngFor="let entity of analysisResult()?.result?.['entities']" class="entity" [attr.data-label]="entity.label">
                {{ entity.text }}
            </span>
        </div>

        <h4>Mais informações sobre a análise</h4>
        <div class="result-metadata">
            <span><strong>ID:</strong> {{ analysisResult()?.id }}</span>
            <span><strong>Motor:</strong> {{ analysisResult()?.engine }}</span>
            <span><strong>Tempo:</strong> {{ analysisResult()?.elapsed_ms }}ms</span>
        </div>

        <ng-template #noEntities>
            <p>Nenhuma entidade encontrada no texto.</p>
        </ng-template>
    </section>
</main>